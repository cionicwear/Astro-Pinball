!function(t){var s={};function i(e){if(s[e])return s[e].exports;var h=s[e]={i:e,l:!1,exports:{}};return t[e].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=s,i.d=function(t,s,e){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var h in t)i.d(e,h,function(s){return t[s]}.bind(null,h));return e},i.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=1)}([function(t,s){let i=!1,e=!0,h=440,l=400;document.addEventListener("keydown",(function(t){38===t.keyCode?i=!0:40===t.keyCode&&(e=!0)}),!1),document.addEventListener("keyup",(function(t){38===t.keyCode?i=!1:40===t.keyCode&&(e=!1)}),!1);class o{constructor(){this.height=o.HEIGHT,this.width=o.WIDTH,this.color=o.COLOR,this.tposY=l,this.tposX=h,this.tposYMax=0,this.downPressed=!0}draw(t){this.downPressed&&this.tposY<480?this.tposY+=1:!1===this.downPressed&&this.tposY>400&&(this.tposY>this.tposYMax&&(this.tposYMax=this.tposY),this.tposYMax%16==0?this.tposY-=17:this.tposY-=16),400===this.tposY&&(this.tposYMax=0)}}o.HEIGHT=60,o.WIDTH=30,o.COLOR="blue",t.exports=o},function(t,s,i){const e=i(2),h=i(13);document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("myCanvas");t.width=e.DIM_X,t.height=e.DIM_Y;const s=t.getContext("2d"),i=new e;new h(i,s).start(),document.getElementById("cionic-connect").onclick=i.websocket,document.getElementById("ble").onclick=i.ble}))},function(t,s,i){const e=i(0),h=i(3),l=i(4),o=i(5),r=i(6),n=i(7),a=i(8),d=i(9),c=i(10),u=i(11),p=i(12);let b=!1;document.addEventListener("keydown",(function(t){32===t.keyCode&&(b=!0)}),!1),document.addEventListener("keyup",(function(t){32===t.keyCode&&(b=!1)}),!1);class m{constructor(t=null){this.thruster=new e,this.ball=new o,this.rightTriangle=new h,this.leftTriangle=new l,this.rightFlipper=new r,this.leftFlipper=new n,this.bumperOne=new a,this.bumperTwo=new d,this.bumperThree=new c,this.leftBump=new u,this.rightBump=new p,this.score=0,this.highscore=0,this.sPressed=!1,this.cjs=t||new cionicjs.Cionic({streamLogger:function(t,s){var i=document.getElementById("log");i.innerHTML+='<div class="'+s+'">&gt;&nbsp;'+t+"</div>",i.scrollTop=i.scrollHeight}}),this.cjs.Stream.registerListener("lPress",function(t){this.leftFlipper.lPressed="OFF"!=t}.bind(this)),this.cjs.Stream.registerListener("rPress",function(t){this.rightFlipper.rPressed="OFF"!=t}.bind(this)),this.cjs.Stream.registerListener("sPress",function(t){this.sPressed="ON"==t,this.thruster.downPressed=!this.thruster.downPressed}.bind(this)),this.cjs.BLE.registerHandler("1",function(){console.log((new Date).getTime()),this.leftFlipper.lPressed=!0}.bind(this)),this.cjs.BLE.registerHandler("2",function(){this.leftFlipper.lPressed=!1}.bind(this)),this.cjs.BLE.registerHandler("3",function(){this.rightFlipper.rPressed=!0}.bind(this)),this.cjs.BLE.registerHandler("4",function(){this.rightFlipper.rPressed=!1}.bind(this)),this.websocket=this.websocket.bind(this),this.ble=this.ble.bind(this)}draw(t){t.clearRect(0,0,m.DIM_X,m.DIM_Y),this.thruster.draw(t),this.ball.draw(t),this.rightTriangle.draw(t),this.leftTriangle.draw(t),this.rightFlipper.draw(t),this.leftFlipper.draw(t),this.bumperOne.draw(t),this.bumperTwo.draw(t),this.bumperThree.draw(t),this.leftBump.draw(t),this.rightBump.draw(t),this.score>this.highscore&&(this.highscore=this.score),document.getElementById("test").innerHTML=this.score,document.getElementById("high").innerHTML=this.highscore,!0!==b&&!0!==this.sPressed||(this.ball.ballPosX=445,this.ball.ballPosY=384,this.ball.ballVelX=0,this.ball.ballVelY=0,this.score=0,document.getElementById("test").innerHTML=this.score,b=!1,this.sPressed=!1)}step(t){445===this.ball.ballPosX&&this.ball.ballPosY+15>this.thruster.tposY?this.ball.thrust(t):445===this.ball.ballPosX&&this.ball.ballPosY<80&&this.ball.firstReflect(t),this.checkCollisions()}checkCollisions(){const t=this.flippers();for(var s=0;s<t.length;s++)this.ball.isCollidedWithLine(t[s])&&this.ball.hitbackFlipper(t[s]);this.ball.ballPosY<=0+this.ball.radius?this.ball.collidewithTopWall():this.ball.ballPosX>=m.DIM_X-this.ball.radius?this.ball.collidewithRightWall():this.ball.ballPosX<=this.ball.radius&&this.ball.collidewithLeftWall();const i=this.bumpers();for(var e=0;e<i.length;e++)this.ball.isCollidedWithBumpers(i[e])&&(this.ball.hitbackBumper(i[e]),this.score+=2===e?7:5);const h=this.bumps();for(var l=0;l<h.length;l++)this.ball.isCollidedWithLine(h[l])?(this.ball.hitbackBump(h[l]),this.score+=3):this.ball.isCollidedwithSideBump(h[l])&&(this.ball.collidewithSideBump(),this.score+=3);const o=this.triangles();for(var r=0;r<o.length;r++)this.ball.isCollidedWithLine(o[r])&&this.ball.hitbackTriangle(o[r])}flippers(){return[].concat(this.rightFlipper,this.leftFlipper)}bumpers(){return[].concat(this.bumperOne,this.bumperTwo,this.bumperThree)}bumps(){return[].concat(this.leftBump,this.rightBump)}triangles(){return[].concat(this.leftTriangle,this.rightTriangle)}websocket(){var t=document.getElementById("host").value;this.cjs.Stream.socket(t)}ble(){this.cjs.ble()}}t.exports=m,m.DIM_X=470,m.DIM_Y=570,m.BG_COLOR="white"},function(t,s){t.exports=class{constructor(){this.height=80,this.pos1={x:410,y:0},this.pos2={x:470,y:80},this.mid={x:440,y:40},this.halfwidth=40,this.halfheight=.5,this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length}}draw(t){t.beginPath(),t.fillStyle="#D74F43",t.moveTo(410,0),t.lineTo(470,0),t.lineTo(470,80),t.fill(),t.beginPath(),t.fillStyle="#D74F43",t.moveTo(470,570),t.lineTo(470,490),t.lineTo(410,570),t.fill()}}},function(t,s){t.exports=class{constructor(){this.height=80,this.pos1={x:60,y:0},this.pos2={x:0,y:80},this.mid={x:30,y:40},this.halfwidth=40,this.halfheight=.5,this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length}}draw(t){t.beginPath(),t.fillStyle="#D74F43",t.moveTo(0,0),t.lineTo(60,0),t.lineTo(0,80),t.fill(),t.beginPath(),t.fillStyle="#D74F43",t.moveTo(0,570),t.lineTo(0,490),t.lineTo(60,570),t.fill()}}},function(t,s,i){i(0);let e=445,h=384,l=.2,o=.8;class r{constructor(t){this.radius=r.RADIUS,this.color=r.COLOR,this.ballPosX=e,this.ballPosY=h,this.ballVelX=0,this.ballVelY=0,this.elasticity=o,this.bounced=!1,this.bouncedTwo=!1}draw(t){let s=document.getElementById("moon"),i=t.createPattern(s,"repeat");t.beginPath(),t.arc(this.ballPosX,this.ballPosY,this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.closePath(),0!==this.ballVelY&&0!==this.ballVelX&&(this.ballVelY+=l),this.speed=Math.sqrt(this.ballVelX*this.ballVelX+this.ballVelY*this.ballVelY),this.dnorm={x:this.ballVelX/this.speed,y:this.ballVelY/this.speed},this.ballPosY+=this.ballVelY,this.ballPosX+=this.ballVelX}thrust(t){this.ballVelY=-12}firstReflect(t){this.ballVelX=Math.random()*(2.6-2.53)-2.6,this.ballVelY=Math.random()*(3.4-3.1)+3.1}isCollidedWithLine(t){let s=Math.abs(this.ballPosX-t.mid.x),i=Math.abs(this.ballPosY-t.mid.y);if(s>t.halfwidth+this.radius)return!1;if(i>t.halfheight+this.radius)return!1;if(s<=t.halfwidth&&!1===this.bouncedTwo)return this.changeBounce(),!0;if(i<=t.halfheight&&!1===this.bouncedTwo)return this.changeBounce(),!0;let e=s-t.halfwidth,h=i-t.halfheight;return e*e+h*h<=this.radius*this.radius&&!1===this.bouncedTwo&&(this.changeBounce(),!0)}hitbackFlipper(t){let s=2*(this.dnorm.x*t.vnorm.x+this.dnorm.y*t.vnorm.y);this.refl={x:t.vnorm.x*s-this.dnorm.x,y:t.vnorm.y*s-this.dnorm.y};let i=Math.sqrt(this.refl.x*this.refl.x+this.refl.y*this.refl.y);this.ballPosY-=4,this.ballVelX=this.refl.x/i*this.speed,this.ballVelY=this.refl.y/i*this.speed*1.07,this.playThud()}playThud(){let t=document.getElementById("thud");t.currentTime=0,t.play()}collidewithTopWall(){this.ballPosY=this.radius,this.ballVelY=-this.ballVelY,this.ballVelY*=this.elasticity}collidewithRightWall(){this.ballPosX=470-this.radius,this.ballVelX=-this.ballVelX,this.ballVelX*=this.elasticity}collidewithLeftWall(){this.ballPosX=this.radius,this.ballVelX=-this.ballVelX,this.ballVelX*=this.elasticity}isCollidedWithBumpers(t){return Math.sqrt(Math.pow(this.ballPosX-t.ballPosX,2)+Math.pow(this.ballPosY-t.ballPosY,2))<this.radius+t.radius&&!1===this.bounced&&(this.bounced=!0,t.radius+=1,setTimeout(()=>{this.bounced=!1,t.radius-=1},200),!0)}hitbackBumper(t){let s=-1/((this.ballPosY-t.ballPosY)/(this.ballPosX-this.ballPosY)),i=1,e=Math.sqrt(s*s+i*i),h=s/e,l=i/e,o=2*(this.dnorm.x*h+this.dnorm.y*l);this.refl={x:h*o-this.dnorm.x,y:l*o-this.dnorm.y};let r=Math.sqrt(this.refl.x*this.refl.x+this.refl.y*this.refl.y);this.ballPosX,t.radius,t.ballPosX,this.radius,this.ballPosY,t.radius,t.ballPosY,this.radius;this.ballVelX=this.refl.x/r*this.speed*1.01,this.ballVelY=this.refl.y/r*this.speed*1.02,this.playBumpSound()}playBumpSound(){let t=document.getElementById("bell");t.currentTime=0,t.volume=.3,t.play()}hitbackBump(t){let s=2*(this.dnorm.x*t.vnorm.x+this.dnorm.y*t.vnorm.y);this.refl={x:t.vnorm.x*s-this.dnorm.x,y:t.vnorm.y*s-this.dnorm.y};let i=Math.sqrt(this.refl.x*this.refl.x+this.refl.y*this.refl.y);this.ballPosY-=2,this.ballVelX=this.refl.x/i*this.speed,this.ballVelY=this.refl.y/i*this.speed,this.playBumpSound()}hitbackTriangle(t){let s=2*(this.dnorm.x*t.vnorm.x+this.dnorm.y*t.vnorm.y);this.refl={x:t.vnorm.x*s-this.dnorm.x,y:t.vnorm.y*s-this.dnorm.y};let i=Math.sqrt(this.refl.x*this.refl.x+this.refl.y*this.refl.y);this.ballPosY-=12,this.ballVelX=this.refl.x/i*this.speed,this.ballVelY=this.refl.y/i*this.speed}isCollidedwithSideBump(t){let s=Math.abs(this.ballPosX-t.mid2.x),i=Math.abs(this.ballPosY-t.mid2.y);if(s>t.halfwidthTwo+this.radius)return!1;if(i>t.halfheightTwo+this.radius)return!1;if(s<=t.halfwidthTwo&&!1===this.bouncedTwo)return this.changeBounce(),!0;if(i<=t.halfheightTwo&&!1===this.bouncedTwo)return this.changeBounce(),!0;let e=s-t.halfwidthTwo,h=i-t.halfheightTwo;return e*e+h*h<=this.radius*this.radius&&!1===this.bouncedTwo&&(this.changeBounce(),!0)}changeBounce(){this.bouncedTwo=!0,setTimeout(()=>{this.bouncedTwo=!1},200)}collidewithSideBump(){this.ballVelX=-this.ballVelX,this.ballVelX*=this.elasticity}}r.RADIUS=15,r.COLOR="blue";t.exports=r},function(t,s){let i=520;t.exports=class{constructor(){this.halfwidth=45,this.halfheight=10,this.pos1={x:350,y:480},this.posY=i,this.mid={x:305,y:(this.posY+480)/2},this.rPressed=!1}draw(t){t.beginPath(),t.moveTo(350,480),t.lineTo(260,this.posY),t.lineWidth=20,t.strokeStyle="#D74F43",t.stroke(),t.closePath(),this.posY=this.posY,this.pos2={x:260,y:this.posY},this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length},this.rPressed&&this.posY>440&&this.flipRightUp(t),!1===this.rPressed&&this.posY<520&&this.flipRightDown(t),this.mid={x:305,y:(this.posY+480)/2}}flipRightUp(t){this.posY-=15,this.mid={x:170,y:(this.posY+480)/2},this.playFlip()}playFlip(){let t=document.getElementById("flip");t.currentTime=0,t.play()}flipRightDown(t){this.posY+=15,this.mid={x:170,y:(this.posY+480)/2}}}},function(t,s){let i=520;t.exports=class{constructor(){this.pos1={x:125,y:480},this.halfwidth=45,this.halfheight=10,this.posY=i,this.mid={x:170,y:(this.posY+480)/2},this.lPressed=!1}draw(t){t.beginPath(),t.moveTo(125,480),t.lineTo(215,this.posY),t.lineWidth=20,t.strokeStyle="#D74F43",t.stroke(),t.closePath(),this.posY=this.posY,this.pos2={x:215,y:this.posY},this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length},this.lPressed&&this.posY>440&&this.flipLeftUp(t),!1===this.lPressed&&this.posY<520&&this.flipLeftDown(t),this.mid={x:170,y:(this.posY+480)/2}}flipLeftUp(t){this.posY-=15,this.mid={x:170,y:(this.posY+480)/2},this.playFlip()}playFlip(){let t=document.getElementById("flip");t.currentTime=0,t.play()}flipLeftDown(t){this.posY+=15,this.mid={x:170,y:(this.posY+480)/2}}}},function(t,s){class i{constructor(){this.radius=i.RADIUS,this.color=i.COLOR,this.ballPosX=155,this.ballPosY=220}draw(t){let s=document.getElementById("mercury"),i=t.createPattern(s,"repeat");t.beginPath(),t.arc(this.ballPosX,this.ballPosY,this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.closePath()}}i.RADIUS=35,i.COLOR="lightgreen",t.exports=i},function(t,s){class i{constructor(){this.radius=i.RADIUS,this.color=i.COLOR,this.ballPosX=325,this.ballPosY=220}draw(t){let s=document.getElementById("mars"),i=t.createPattern(s,"repeat");t.beginPath(),t.arc(this.ballPosX,this.ballPosY,this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.closePath()}}i.RADIUS=35,i.COLOR="lightgreen",t.exports=i},function(t,s){class i{constructor(){this.radius=i.RADIUS,this.color=i.COLOR,this.ballPosX=240,this.ballPosY=120}draw(t){let s=document.getElementById("neptune"),i=t.createPattern(s,"repeat");t.beginPath(),t.arc(this.ballPosX,this.ballPosY,this.radius,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.closePath()}}i.RADIUS=35,i.COLOR="lightgreen",t.exports=i},function(t,s){t.exports=class{constructor(){this.height=80,this.pos1={x:50,y:370},this.pos2={x:120,y:450},this.mid={x:85,y:410},this.mid2={x:50,y:410},this.halfwidth=35,this.halfheight=.5,this.halfwidthTwo=.5,this.halfheightTwo=40,this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length}}draw(t){let s=document.getElementById("earth"),i=t.createPattern(s,"repeat");t.beginPath(),t.fillStyle=i,t.moveTo(50,450),t.lineTo(120,450),t.lineTo(50,370),t.fill()}}},function(t,s){t.exports=class{constructor(){this.height=80,this.pos1={x:420,y:370},this.pos2={x:350,y:450},this.mid={x:385,y:410},this.mid2={x:420,y:410},this.halfwidth=35,this.halfheight=.5,this.halfwidthTwo=.5,this.halfheightTwo=40,this.vec={x:this.pos2.x-this.pos1.x,y:this.pos2.y-this.pos1.y},this.length=Math.sqrt(this.vec.x*this.vec.x+this.vec.y*this.vec.y),this.vnorm={x:this.vec.x/this.length,y:this.vec.y/this.length}}draw(t){let s=document.getElementById("earth"),i=t.createPattern(s,"repeat");t.beginPath(),t.fillStyle=i,t.moveTo(350,450),t.lineTo(420,450),t.lineTo(420,370),t.fill()}}},function(t,s){document.addEventListener("keydown",(function(t){77===t.keyCode&&function(){let t=document.getElementById("audio");document.getElementById("bell"),document.getElementById("thud"),document.getElementById("flip");!1===t.muted?(document.getElementById("audio").muted=!0,document.getElementById("bell").muted=!0,document.getElementById("thud").muted=!0,document.getElementById("flip").muted=!0):(document.getElementById("audio").muted=!1,document.getElementById("bell").muted=!1,document.getElementById("thud").muted=!1,document.getElementById("flip").muted=!1)}()}),!1),t.exports=class{constructor(t,s){this.game=t,this.ctx=s}start(){this.lastTime=0,requestAnimationFrame(this.animate.bind(this))}animate(t){const s=t-this.lastTime;this.game.step(s),this.game.draw(this.ctx),this.lastTime=t,requestAnimationFrame(this.animate.bind(this))}}}]);
//# sourceMappingURL=bundle.js.map